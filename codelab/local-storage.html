<!doctype html><html lang=en><head><meta charset=utf-8><title>Yeoman - Modern workflows for modern webapps</title><meta name=viewport content="width=device-width"><link href="http://fonts.googleapis.com/css?family=Droid+Sans:400,700|Lekton|Ubuntu+Mono:400,700" rel=stylesheet><link rel=stylesheet href=/yeoman.io/assets/css/main.273e.css><script src=/yeoman.io//ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js></script><script src=/yeoman.io/assets/js/scripts.9866.js></script></head><body class=""><style>body { background: white; }
img { max-width: 100%; }
img.spacer { margin: 0 auto; height: 250px; display: block; }
.mast-holder { width: 100%; text-align: center; }
.mast { margin: 0 auto; width: 350px; }
.note { background: #f2dede; padding: 15px; }
.social { margin: 0 auto; }
.authors { text-align: center; font-style: italic; }
ul, li {
  -webkit-margin-before: 0;
}
.codelab-paging {
  margin-top: 2em;
  text-align: center;
}
.codelab-paging a {
  margin: 0 1em;
  font-weight: bold;
}</style><nav><header><a href=/yeoman.io/index.html><img src=/yeoman.io/assets/img/yeoman-logo.a053.png></a></header><ul><li class=nav-divider><a href=/yeoman.io/index.html><img src=/yeoman.io/assets/img/icon-home.e05d.png>Home</a></li><li class=nav-divider><a href=/yeoman.io/whyyeoman.html><img src=/yeoman.io/assets/img/icon-why-yeoman.d00f.png>Why Yeoman?</a></li><li class=nav-divider><a href=/yeoman.io/gettingstarted.html><img src=/yeoman.io/assets/img/icon-getting-started.49a8.png>Getting Started</a></li><li class=nav-sub><a href=/yeoman.io/codelab.html>Codelab</a></li><li class=nav-sub><a href=/yeoman.io/videos.html>Videos</a></li><li class=nav-sub><a href=/yeoman.io/about.html>About</a></li><li class=nav-sub><a href=/yeoman.io/deployment.html>Deployment</a></li><li class=nav-sub><a href=/yeoman.io/support.html>Support</a></li><li class=nav-sub><a href=/yeoman.io/articles.html>Articles</a></li><li class=nav-divider><a href=/yeoman.io/blog>Blog</a></li><li class=nav-divider><a href=/yeoman.io/generators.html>Generators</a></li><li class=nav-sub><a href=/yeoman.io/official-generators.html>Official Generators</a></li><li class=nav-sub><a href=/yeoman.io/community-generators.html>Community Generators</a></li><li class=nav-sub><a href=/yeoman.io/generators.html#writing-your-first-generator>Write Your First Generator</a></li><li class=nav-sub><a href=/yeoman.io/generators.html#get-help>Get Help</a></li><li class=nav-sub><a href=/yeoman.io/generators.html#reference-materials>Reference Materials</a></li><li class=nav-sub><a href=/yeoman.io/generators.html#snippets>Snippets</a></li><li class=nav-sub><a href=/yeoman.io/generators.html#frequently-asked-questions>FAQ</a></li><li class=nav-divider><a href=https://github.com/yeoman/yeoman/wiki><img src=/yeoman.io/assets/img/icon-documentation.eec7.png>Documentation</a></li><li class=nav-divider><a href=/yeoman.io/faq.html><img src=/yeoman.io/assets/img/icon-faqs.9efe.png>FAQ</a></li><li class=nav-divider><a href=https://plus.google.com/101063139999404044459/posts><img src=/yeoman.io/assets/img/icon-google-plus.4a25.png>Google&#43;</a></li><li><a href=http://twitter.com/yeoman><img src=/yeoman.io/assets/img/icon-twitter.0fb3.png>Twitter</a></li><li><a href=http://github.com/yeoman/yeoman><img src=/yeoman.io/assets/img/icon-github.6fa5.png>GitHub</a></li><li><a href=/yeoman.io/blog/atom.xml type=application/atom+xml><img src=/yeoman.io/assets/img/icon-rss-feed.8868.png>Blog Feed</a></li><li class=nav-divider><a href=https://github.com/yeoman/yeoman/blob/master/contributing.md><img src=/yeoman.io/assets/img/icon-contributing.9ac9.png>Contributing</a></li></ul></nav><div id=content><article><div class=social><a href=https://twitter.com/share class=twitter-share-button data-url=http://yeoman.io/codelab.html data-text="Let's Scaffold A Web App With Yeoman!">Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script><script src=https://apis.google.com/js/plusone.js></script><g:plus action=share></g:plus></div><h1>Make Todos Persistent with Local Storage</h1><p>Let’s revisit the issue of items not persisting when the browser refreshes.</p><p>To easily achieve this we can use another Angular module called ‘<a href=http://gregpike.net/demos/angular-local-storage/demo.html>angular-local-storage</a>’ that will allow us to quickly implement <a href=http://diveintohtml5.info/storage.html>Local Storage</a>. Again, Bower comes to the rescue. Run the following command:</p><div class=highlight><pre><code class="text language-text" data-lang=text>$ bower install --save angular-local-storage
</code></pre></div><p><img src=/yeoman.io/assets/img/codelab/image_29.3ba2.png alt=""></p><p>Similar to how we added jQueryUI and AngularUI Sortable, we need to add a reference to the angular-local-storage.js file in index.html:</p><div class=highlight><pre><code class="html language-html" data-lang=html><span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/angular-local-storage/angular-local-storage.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
</code></pre></div><p>Since we&#39;re using bower.json to keep track of our modules, <code>Ctrl+C</code> to exit the current command line process, then re-run <code>grunt serve</code> to get some automated magic in your index.html.</p><p>Your index.html scripts should now look like this:</p><div class=highlight><pre><code class="html language-html" data-lang=html><span class=c>&lt;!-- build:js scripts/vendor.js --&gt;</span>
<span class=c>&lt;!-- bower:js --&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/jquery/jquery.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/angular/angular.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/bootstrap/dist/js/bootstrap.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/angular-resource/angular-resource.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/angular-cookies/angular-cookies.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/angular-sanitize/angular-sanitize.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/angular-route/angular-route.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/jquery-ui/ui/jquery-ui.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/angular-ui-sortable/sortable.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=nt>&lt;script </span><span class=na>src=</span><span class=s>&quot;bower_components/angular-local-storage/angular-local-storage.js&quot;</span><span class=nt>&gt;&lt;/script&gt;</span>
<span class=c>&lt;!-- endbower --&gt;</span>
<span class=c>&lt;!-- endbuild --&gt;</span>
</code></pre></div><p>Edit the todo module (scripts/app.js) to include the localStorage adapter:</p><div class=highlight><pre><code class="js language-js" data-lang=js><span class=nx>angular</span><span class=p>.</span><span class=nx>module</span><span class=p>(</span><span class=s1>&#39;mytodoApp&#39;</span><span class=p>,</span> <span class=p>[</span>
  <span class=s1>&#39;ngCookies&#39;</span><span class=p>,</span>
  <span class=s1>&#39;ngResource&#39;</span><span class=p>,</span>
  <span class=s1>&#39;ngSanitize&#39;</span><span class=p>,</span>
  <span class=s1>&#39;ngRoute&#39;</span><span class=p>,</span>
  <span class=s1>&#39;ui.sortable&#39;</span><span class=p>,</span>
  <span class=s1>&#39;LocalStorageModule&#39;</span>
<span class=p>])</span>
</code></pre></div><p>While you’re in app.js, also configure &#39;localStorageServiceProvider&#39; to use ‘todo’ as a localStorage name prefix so your app doesn’t accidently read todos from another app using the same variable names:</p><div class=highlight><pre><code class="js language-js" data-lang=js><span class=p>.</span><span class=nx>config</span><span class=p>([</span><span class=s1>&#39;localStorageServiceProvider&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>localStorageServiceProvider</span><span class=p>){</span>
  <span class=nx>localStorageServiceProvider</span><span class=p>.</span><span class=nx>setPrefix</span><span class=p>(</span><span class=s1>&#39;ls&#39;</span><span class=p>);</span>
<span class=p>}])</span>
</code></pre></div><p>Our todo module (scripts/app.js) should now look like this:</p><div class=highlight><pre><code class="js language-js" data-lang=js><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>

<span class=nx>angular</span><span class=p>.</span><span class=nx>module</span><span class=p>(</span><span class=s1>&#39;mytodoApp&#39;</span><span class=p>,</span> <span class=p>[</span>
  <span class=s1>&#39;ngCookies&#39;</span><span class=p>,</span>
  <span class=s1>&#39;ngResource&#39;</span><span class=p>,</span>
  <span class=s1>&#39;ngSanitize&#39;</span><span class=p>,</span>
  <span class=s1>&#39;ngRoute&#39;</span><span class=p>,</span>
  <span class=s1>&#39;ui.sortable&#39;</span><span class=p>,</span>
  <span class=s1>&#39;LocalStorageModule&#39;</span>
<span class=p>])</span>
  <span class=p>.</span><span class=nx>config</span><span class=p>([</span><span class=s1>&#39;localStorageServiceProvider&#39;</span><span class=p>,</span> <span class=kd>function</span><span class=p>(</span><span class=nx>localStorageServiceProvider</span><span class=p>){</span>
    <span class=nx>localStorageServiceProvider</span><span class=p>.</span><span class=nx>setPrefix</span><span class=p>(</span><span class=s1>&#39;ls&#39;</span><span class=p>);</span>
  <span class=p>}])</span>
  <span class=p>.</span><span class=nx>config</span><span class=p>(</span><span class=kd>function</span> <span class=p>(</span><span class=nx>$routeProvider</span><span class=p>)</span> <span class=p>{</span>
    <span class=nx>$routeProvider</span>
      <span class=p>.</span><span class=nx>when</span><span class=p>(</span><span class=s1>&#39;/&#39;</span><span class=p>,</span> <span class=p>{</span>
        <span class=nx>templateUrl</span><span class=o>:</span> <span class=s1>&#39;views/main.html&#39;</span><span class=p>,</span>
        <span class=nx>controller</span><span class=o>:</span> <span class=s1>&#39;MainCtrl&#39;</span>
      <span class=p>})</span>
      <span class=p>.</span><span class=nx>otherwise</span><span class=p>({</span>
        <span class=nx>redirectTo</span><span class=o>:</span> <span class=s1>&#39;/&#39;</span>
      <span class=p>});</span>
  <span class=p>});</span>
</code></pre></div><p>You will also need to update your controller (scripts/controllers/main.js) to declare a dependency on the localStorage service. Add ‘localStorageService’ as the second parameter in the callback function.</p><div class=highlight><pre><code class="js language-js" data-lang=js><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>

<span class=nx>angular</span><span class=p>.</span><span class=nx>module</span><span class=p>(</span><span class=s1>&#39;mytodoApp&#39;</span><span class=p>)</span>
  <span class=p>.</span><span class=nx>controller</span><span class=p>(</span><span class=s1>&#39;MainCtrl&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>$scope</span><span class=p>,</span> <span class=nx>localStorageService</span><span class=p>)</span> <span class=p>{</span>
    <span class=c1>// (code hidden here to save space)</span>
  <span class=p>});</span>
</code></pre></div><p>So now, rather than reading our todos from a static array, we’ll be reading it from Local Storage and then storing it in <code>$scope.todos</code> instead.</p><p>We’ll also use the angular <a href=http://docs.angularjs.org/api/ng.$rootScope.Scope#methods_$watch>$watch</a> listener to watch for changes in the value of $scope.todos. If someone adds or removes a todo, it will then keep our localStorage <code>todos</code> datastore in sync:</p><p>Therefore, we need to remove the current $scope.todos declaration:</p><div class=highlight><pre><code class="js language-js" data-lang=js><span class=nx>$scope</span><span class=p>.</span><span class=nx>todos</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;Item 1&#39;</span><span class=p>,</span> <span class=s1>&#39;Item 2&#39;</span><span class=p>,</span> <span class=s1>&#39;Item 3&#39;</span><span class=p>];</span>
</code></pre></div><p>And replace it with this:</p><div class=highlight><pre><code class="js language-js" data-lang=js><span class=kd>var</span> <span class=nx>todosInStore</span> <span class=o>=</span> <span class=nx>localStorageService</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;todos&#39;</span><span class=p>);</span>

<span class=nx>$scope</span><span class=p>.</span><span class=nx>todos</span> <span class=o>=</span> <span class=nx>todosInStore</span> <span class=o>&amp;&amp;</span> <span class=nx>todosInStore</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;\n&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=p>[];</span>

<span class=nx>$scope</span><span class=p>.</span><span class=nx>$watch</span><span class=p>(</span><span class=s1>&#39;todos&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
  <span class=nx>localStorageService</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;todos&#39;</span><span class=p>,</span> <span class=nx>$scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s1>&#39;\n&#39;</span><span class=p>));</span>
<span class=p>},</span> <span class=kc>true</span><span class=p>);</span>
</code></pre></div><p>We now have a controller that is as follows:</p><div class=highlight><pre><code class="js language-js" data-lang=js><span class=s1>&#39;use strict&#39;</span><span class=p>;</span>

<span class=nx>angular</span><span class=p>.</span><span class=nx>module</span><span class=p>(</span><span class=s1>&#39;mytodoApp&#39;</span><span class=p>)</span>
  <span class=p>.</span><span class=nx>controller</span><span class=p>(</span><span class=s1>&#39;MainCtrl&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>$scope</span><span class=p>,</span> <span class=nx>localStorageService</span><span class=p>)</span> <span class=p>{</span>

    <span class=kd>var</span> <span class=nx>todosInStore</span> <span class=o>=</span> <span class=nx>localStorageService</span><span class=p>.</span><span class=nx>get</span><span class=p>(</span><span class=s1>&#39;todos&#39;</span><span class=p>);</span>

    <span class=nx>$scope</span><span class=p>.</span><span class=nx>todos</span> <span class=o>=</span> <span class=nx>todosInStore</span> <span class=o>&amp;&amp;</span> <span class=nx>todosInStore</span><span class=p>.</span><span class=nx>split</span><span class=p>(</span><span class=s1>&#39;\n&#39;</span><span class=p>)</span> <span class=o>||</span> <span class=p>[];</span>

    <span class=nx>$scope</span><span class=p>.</span><span class=nx>$watch</span><span class=p>(</span><span class=s1>&#39;todos&#39;</span><span class=p>,</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
      <span class=nx>localStorageService</span><span class=p>.</span><span class=nx>add</span><span class=p>(</span><span class=s1>&#39;todos&#39;</span><span class=p>,</span> <span class=nx>$scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>join</span><span class=p>(</span><span class=s1>&#39;\n&#39;</span><span class=p>));</span>
    <span class=p>},</span> <span class=kc>true</span><span class=p>);</span>

    <span class=nx>$scope</span><span class=p>.</span><span class=nx>addTodo</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>()</span> <span class=p>{</span>
      <span class=nx>$scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>$scope</span><span class=p>.</span><span class=nx>todo</span><span class=p>);</span>
      <span class=nx>$scope</span><span class=p>.</span><span class=nx>todo</span> <span class=o>=</span> <span class=s1>&#39;&#39;</span><span class=p>;</span>
    <span class=p>};</span>

    <span class=nx>$scope</span><span class=p>.</span><span class=nx>removeTodo</span> <span class=o>=</span> <span class=kd>function</span> <span class=p>(</span><span class=nx>index</span><span class=p>)</span> <span class=p>{</span>
      <span class=nx>$scope</span><span class=p>.</span><span class=nx>todos</span><span class=p>.</span><span class=nx>splice</span><span class=p>(</span><span class=nx>index</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
    <span class=p>};</span>

  <span class=p>});</span>
</code></pre></div><p>If you look at your app in the browser now you’ll see that there are no items in the todo list. The app is initialising the todos array from localStorage and we haven’t given it any todo items yet.</p><p><img src=/yeoman.io/assets/img/codelab/image_30.01cb.png alt=""></p><p>Go ahead and add a few items to the list:</p><p><img src=/yeoman.io/assets/img/codelab/image_31.3851.png alt=""></p><p>Now when we refresh our browser the items persist. Hooray!</p><p>We can confirm whether our data is being persisted to localStorage by checking the Resources panel in Chrome DevTools and selecting &quot;Local Storage&quot; from the lefthand side:</p><p><img src=/yeoman.io/assets/img/codelab/image_32.c515.png alt=""></p><p class=codelab-paging><a href=../codelab.html#toc>&laquo; Return to overview</a> or <a href=prepare-production.html>Go to the next step &raquo;</a></p></article></div><script>// $script.js - github.com/ded/script.js
  (function(a,b,c){typeof c["module"]!="undefined"&&c.module.exports?c.module.exports=b():typeof c["define"]!="undefined"&&c["define"]=="function"&&c.define.amd?define(a,b):c[a]=b()})("$script",function(){function p(a,b){for(var c=0,d=a.length;c<d;++c)if(!b(a[c]))return j;return 1}function q(a,b){p(a,function(a){return!b(a)})}function r(a,b,i){function o(a){return a.call?a():d[a]}function t(){if(!--n){d[m]=1,l&&l();for(var a in f)p(a.split("|"),o)&&!q(f[a],o)&&(f[a]=[])}}a=a[k]?a:[a];var j=b&&b.call,l=j?b:i,m=j?a.join(""):b,n=a.length;return setTimeout(function(){q(a,function(a){if(h[a])return m&&(e[m]=1),h[a]==2&&t();h[a]=1,m&&(e[m]=1),s(!c.test(a)&&g?g+a+".js":a,t)})},0),r}function s(c,d){var e=a.createElement("script"),f=j;e.onload=e.onerror=e[o]=function(){if(e[m]&&!/^c|loade/.test(e[m])||f)return;e.onload=e[o]=null,f=1,h[c]=2,d()},e.async=1,e.src=c,b.insertBefore(e,b.firstChild)}var a=document,b=a.getElementsByTagName("head")[0],c=/^https?:\/\//,d={},e={},f={},g,h={},i="string",j=!1,k="push",l="DOMContentLoaded",m="readyState",n="addEventListener",o="onreadystatechange";return!a[m]&&a[n]&&(a[n](l,function t(){a.removeEventListener(l,t,j),a[m]="complete"},j),a[m]="loading"),r.get=s,r.order=function(a,b,c){(function d(e){e=a.shift(),a.length?r(e,d):r(e,b,c)})()},r.path=function(a){g=a},r.ready=function(a,b,c){a=a[k]?a:[a];var e=[];return!q(a,function(a){d[a]||e[k](a)})&&p(a,function(a){return d[a]})?b():!function(a){f[a]=f[a]||[],f[a][k](b),c&&c(e)}(a.join("|")),r},r},this)
  var _gaq=[
    ['_setAccount','UA-32956520-1'],
    ['_setDomainName', '.yeoman.io'],
    ['_trackPageview'],['_trackPageLoadTime']
  ];
  $script('http://www.google-analytics.com/ga.js');
  $script('https://apis.google.com/js/plusone.js');
  $script("//platform.twitter.com/widgets.js");</script></body></html>